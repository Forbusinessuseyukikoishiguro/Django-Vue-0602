Vue.js ä¿é™ºå•†å“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰è©³ç´°è§£èª¬
# ğŸš€ Vue.js ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ

## ğŸ“¦ åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–‡
```javascript
import { mount, createLocalVue } from '@vue/test-utils'
import flushPromises from 'flush-promises'
import MockAdapter from 'axios-mock-adapter'
import Router from 'vue-router'
import Vuex from 'vuex'
import MyComponent from '@/components/MyComponent.vue'
```

### åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆæ§‹é€ 
```javascript
describe('ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå', () => {
  let wrapper
  let store
  let mockAxios

  beforeEach(() => {
    // å„ãƒ†ã‚¹ãƒˆå‰ã®åˆæœŸåŒ–
  })

  afterEach(() => {
    // å„ãƒ†ã‚¹ãƒˆå¾Œã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  })

  it('ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å', async () => {
    // ãƒ†ã‚¹ãƒˆå†…å®¹
  })
})
```

## ğŸ› ï¸ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒã‚¦ãƒ³ãƒˆ

### ã‚·ãƒ³ãƒ—ãƒ«ãªãƒã‚¦ãƒ³ãƒˆ
```javascript
wrapper = mount(MyComponent)
```

### å…¨éƒ¨ç››ã‚Šãƒã‚¦ãƒ³ãƒˆ
```javascript
const localVue = createLocalVue()
localVue.use(Router)
localVue.use(Vuex)

wrapper = mount(MyComponent, {
  localVue,
  propsData: { prop1: 'value' },           // props
  mocks: { $cookies: mockCookies },        // ãƒ¢ãƒƒã‚¯
  stubs: ['ChildComponent'],               // å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¹ã‚¿ãƒ–åŒ–
  store: mockStore,                        // Vuex ã‚¹ãƒˆã‚¢
  router: new Router()                     // Vue Router
})
```

## ğŸ¯ DOMæ“ä½œã¨ã‚¤ãƒ™ãƒ³ãƒˆ

### è¦ç´ ã®å–å¾—
```javascript
wrapper.find('.class-name')           // ã‚¯ãƒ©ã‚¹åã§å–å¾—
wrapper.find('#id-name')              // ID ã§å–å¾—
wrapper.find('button')                // ã‚¿ã‚°åã§å–å¾—
wrapper.find('[data-testid="test"]')  // dataå±æ€§ã§å–å¾—
wrapper.findAll('.item')              // è¤‡æ•°è¦ç´ ã‚’å–å¾—
```

### å…¥åŠ›æ“ä½œ
```javascript
// ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
wrapper.find('input').setValue('ãƒ†ã‚­ã‚¹ãƒˆ')

// ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹/ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³
wrapper.find('input[type="checkbox"]').setChecked()
wrapper.find('input[value="option1"]').setChecked()

// ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹
wrapper.find('select').setValue('value')

// ã‚¯ãƒªãƒƒã‚¯
wrapper.find('button').trigger('click')

// ãã®ä»–ã®ã‚¤ãƒ™ãƒ³ãƒˆ
wrapper.find('input').trigger('focus')
wrapper.find('form').trigger('submit')
```

### ãƒ‡ãƒ¼ã‚¿è¨­å®š
```javascript
// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ¥å¤‰æ›´
wrapper.setData({ count: 5 })

// props ã‚’å¤‰æ›´
wrapper.setProps({ message: 'æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸' })
```

## â° éåŒæœŸå‡¦ç†ã®å¾…æ©Ÿ

```javascript
// Promise ã®å®Œäº†ã‚’å¾…ã¤
await flushPromises()

// Vue ã® DOM æ›´æ–°ã‚’å¾…ã¤
await wrapper.vm.$nextTick()

// çµ„ã¿åˆã‚ã›ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚ˆãä½¿ã†ï¼‰
wrapper.find('button').trigger('click')
await flushPromises()
await wrapper.vm.$nextTick()
```

## ğŸ­ ãƒ¢ãƒƒã‚¯ä½œæˆ

### API ãƒ¢ãƒƒã‚¯ (axios)
```javascript
import MockAdapter from 'axios-mock-adapter'
import api from '@/services/api'

const mockAxios = new MockAdapter(api)

// GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ¢ãƒƒã‚¯
mockAxios.onGet('/api/users').reply(200, { users: [] })

// POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ¢ãƒƒã‚¯
mockAxios.onPost('/api/login').reply(200, { token: 'abc123' })

// ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
mockAxios.onGet('/api/error').reply(500, { error: 'Server Error' })
```

### é–¢æ•°ãƒ¢ãƒƒã‚¯
```javascript
// Jest ãƒ¢ãƒƒã‚¯é–¢æ•°
const mockFunction = jest.fn()
mockFunction.mockReturnValue('æˆ»ã‚Šå€¤')
mockFunction.mockResolvedValue('Promiseæˆ»ã‚Šå€¤')

// ãƒ–ãƒ©ã‚¦ã‚¶ API ã®ãƒ¢ãƒƒã‚¯
window.scrollTo = jest.fn()
window.alert = jest.fn()
```

### Vuex ã‚¹ãƒˆã‚¢ãƒ¢ãƒƒã‚¯
```javascript
const mockStore = new Vuex.Store({
  modules: {
    user: {
      namespaced: true,
      state: { name: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼' },
      actions: { login: jest.fn() },
      mutations: { setUser: jest.fn() },
      getters: { isLoggedIn: () => true }
    }
  }
})
```

## âœ… ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¤œè¨¼ï¼‰

### è¡¨ç¤º/éè¡¨ç¤ºã®ç¢ºèª
```javascript
expect(wrapper.find('.message').exists()).toBe(true)     // è¦ç´ ãŒå­˜åœ¨ã™ã‚‹
expect(wrapper.find('.error').exists()).toBe(false)     // è¦ç´ ãŒå­˜åœ¨ã—ãªã„
expect(wrapper.find('.modal').isVisible()).toBe(true)   // è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹
```

### ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ã®ç¢ºèª
```javascript
expect(wrapper.find('h1').text()).toBe('ã‚¿ã‚¤ãƒˆãƒ«')
expect(wrapper.find('.message').text()).toContain('æˆåŠŸ')
expect(wrapper.html()).toMatchSnapshot()  // ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
```

### çŠ¶æ…‹ã®ç¢ºèª
```javascript
// ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹
expect(wrapper.find('input[type="checkbox"]').element.checked).toBe(true)

// å…¥åŠ›å€¤
expect(wrapper.find('input').element.value).toBe('å…¥åŠ›å€¤')

// CSS ã‚¯ãƒ©ã‚¹
expect(wrapper.find('.button').classes()).toContain('active')

// å±æ€§
expect(wrapper.find('button').attributes('disabled')).toBeDefined()
```

### é–¢æ•°å‘¼ã³å‡ºã—ã®ç¢ºèª
```javascript
expect(mockFunction).toHaveBeenCalled()                 // å‘¼ã³å‡ºã•ã‚ŒãŸ
expect(mockFunction).toHaveBeenCalledTimes(2)          // 2å›å‘¼ã³å‡ºã•ã‚ŒãŸ
expect(mockFunction).toHaveBeenCalledWith('å¼•æ•°')       // ç‰¹å®šã®å¼•æ•°ã§å‘¼ã³å‡ºã•ã‚ŒãŸ
```

## ğŸ”„ ã‚ˆãä½¿ã†ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§APIãŒå‘¼ã°ã‚Œã‚‹ãƒ†ã‚¹ãƒˆ
```javascript
it('ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§APIãŒå‘¼ã°ã‚Œã‚‹', async () => {
  mockAxios.onPost('/api/save').reply(200, { success: true })
  
  wrapper.find('.save-button').trigger('click')
  await flushPromises()
  
  expect(mockAxios.history.post.length).toBe(1)
  expect(mockAxios.history.post[0].url).toBe('/api/save')
})
```

### ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®ãƒ†ã‚¹ãƒˆ
```javascript
it('ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã§æ­£ã—ã„ãƒ‡ãƒ¼ã‚¿ãŒé€ã‚‰ã‚Œã‚‹', async () => {
  wrapper.find('#name').setValue('ãƒ†ã‚¹ãƒˆå¤ªéƒ')
  wrapper.find('#email').setValue('test@example.com')
  wrapper.find('form').trigger('submit')
  
  await flushPromises()
  
  expect(wrapper.emitted('submit')).toBeTruthy()
  expect(wrapper.emitted('submit')[0][0]).toEqual({
    name: 'ãƒ†ã‚¹ãƒˆå¤ªéƒ',
    email: 'test@example.com'
  })
})
```

### æ¡ä»¶åˆ†å²ã®è¡¨ç¤ºãƒ†ã‚¹ãƒˆ
```javascript
it('ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã«ã‚ˆã£ã¦è¡¨ç¤ºãŒå¤‰ã‚ã‚‹', async () => {
  // ãƒ­ã‚°ã‚¤ãƒ³å‰
  expect(wrapper.find('.login-button').exists()).toBe(true)
  expect(wrapper.find('.logout-button').exists()).toBe(false)
  
  // ãƒ­ã‚°ã‚¤ãƒ³å¾Œ
  wrapper.setData({ isLoggedIn: true })
  await wrapper.vm.$nextTick()
  
  expect(wrapper.find('.login-button').exists()).toBe(false)
  expect(wrapper.find('.logout-button').exists()).toBe(true)
})
```

## âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•

```javascript
// âŒ éåŒæœŸå‡¦ç†ã‚’å¾…ãŸãšã«ãƒ†ã‚¹ãƒˆã—ã¦ã„ã‚‹
wrapper.find('button').trigger('click')
expect(wrapper.find('.result').text()).toBe('çµæœ')  // å¤±æ•—

// âœ… æ­£ã—ã„æ›¸ãæ–¹
wrapper.find('button').trigger('click')
await flushPromises()
await wrapper.vm.$nextTick()
expect(wrapper.find('.result').text()).toBe('çµæœ')  // æˆåŠŸ
```

```javascript
// âŒ è¦ç´ ãŒè¦‹ã¤ã‹ã‚‰ãªã„
expect(wrapper.find('.not-exists').text()).toBe('text')  // ã‚¨ãƒ©ãƒ¼

// âœ… å­˜åœ¨ç¢ºèªã—ã¦ã‹ã‚‰ãƒ†ã‚¹ãƒˆ
if (wrapper.find('.maybe-exists').exists()) {
  expect(wrapper.find('.maybe-exists').text()).toBe('text')
}
```

### ãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒ¼ãƒ‰
```javascript
// HTMLæ§‹é€ ã‚’ç¢ºèª
console.log(wrapper.html())

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
console.log(wrapper.vm.$data)

// ç™ºç”Ÿã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’ç¢ºèª
console.log(wrapper.emitted())
```

## ğŸ† ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ†ã‚¹ãƒˆåã¯å…·ä½“çš„ã«
```javascript
// âŒ æ‚ªã„ä¾‹
it('ãƒœã‚¿ãƒ³ã®ãƒ†ã‚¹ãƒˆ', () => {})

// âœ… è‰¯ã„ä¾‹
it('ä¿å­˜ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨APIãŒå‘¼ã°ã‚Œã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {})
```

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆIDã‚’ä½¿ç”¨
```javascript
// HTML
<button data-testid="save-button">ä¿å­˜</button>

// ãƒ†ã‚¹ãƒˆ
wrapper.find('[data-testid="save-button"]')
```

### 3. å…±é€šå‡¦ç†ã¯é–¢æ•°åŒ–
```javascript
const fillForm = (wrapper, data) => {
  wrapper.find('#name').setValue(data.name)
  wrapper.find('#email').setValue(data.email)
}

const submitAndWait = async (wrapper) => {
  wrapper.find('form').trigger('submit')
  await flushPromises()
  await wrapper.vm.$nextTick()
}
```

### 4. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯å¤–éƒ¨åŒ–
```javascript
const testUsers = [
  { id: 1, name: 'ãƒ†ã‚¹ãƒˆå¤ªéƒ', email: 'test1@example.com' },
  { id: 2, name: 'ãƒ†ã‚¹ãƒˆèŠ±å­', email: 'test2@example.com' }
]
```

## ğŸ“š ä¾¿åˆ©ãªãƒãƒƒãƒãƒ£ãƒ¼ä¸€è¦§

```javascript
// åŸºæœ¬
expect(value).toBe(expected)           // å®Œå…¨ä¸€è‡´
expect(value).toEqual(expected)        // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å†…å®¹ä¸€è‡´
expect(value).not.toBe(expected)       // ä¸ä¸€è‡´

// æ–‡å­—åˆ—
expect(string).toContain('éƒ¨åˆ†æ–‡å­—åˆ—')
expect(string).toMatch(/æ­£è¦è¡¨ç¾/)

// æ•°å€¤
expect(number).toBeGreaterThan(3)      // 3ã‚ˆã‚Šå¤§ãã„
expect(number).toBeLessThan(5)         // 5ã‚ˆã‚Šå°ã•ã„
expect(number).toBeCloseTo(2.2, 1)     // è¿‘ä¼¼å€¤

// é…åˆ—/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
expect(array).toContain(item)          // é…åˆ—ã«è¦ç´ ãŒå«ã¾ã‚Œã‚‹
expect(object).toHaveProperty('key')   // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤

// é–¢æ•°
expect(fn).toHaveBeenCalled()          // å‘¼ã³å‡ºã•ã‚ŒãŸ
expect(fn).toThrow()                   // ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹

// Promise
await expect(promise).resolves.toBe(value)   // æˆåŠŸæ™‚ã®å€¤
await expect(promise).rejects.toThrow()      // å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼
```

## ğŸ¯ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã‚’æ›¸ãå‰ã«
- [ ] ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®æ©Ÿèƒ½ã‚’æ˜ç¢ºã«ã™ã‚‹
- [ ] å¿…è¦ãªãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ã™ã‚‹
- [ ] ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹

### ãƒ†ã‚¹ãƒˆã‚’æ›¸ãæ™‚ã«
- [ ] 1ã¤ã®ãƒ†ã‚¹ãƒˆã§1ã¤ã®æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹
- [ ] éåŒæœŸå‡¦ç†ã®å¾…æ©Ÿã‚’å¿˜ã‚Œãªã„
- [ ] ã‚ã‹ã‚Šã‚„ã™ã„ãƒ†ã‚¹ãƒˆåã‚’ã¤ã‘ã‚‹
- [ ] å¿…è¦æœ€å°é™ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«ã™ã‚‹

### ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸå¾Œã«
- [ ] ãƒ†ã‚¹ãƒˆãŒæ­£ã—ãå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ä¸è¦ãªã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’å‰Šé™¤
- [ ] ä»–ã®ãƒ†ã‚¹ãƒˆã«å½±éŸ¿ã—ãªã„ã‹ç¢ºèª
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å—ã‘ã‚‹

---

**ğŸ’¡ ã‚³ãƒ”ãƒšã—ã¦ä½¿ã£ã¦ã­ï¼æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®å‘³æ–¹ã«ãªã‚‹ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã§ã™ï¼**

ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
è²¼ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ä¸€è¡Œãšã¤ã‚³ãƒ¡ãƒ³ãƒˆä»˜ãã§è§£èª¬ã—ã¾ã™ï¼ä¸Šè¨˜ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã§ã€è²¼ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä¸»è¦éƒ¨åˆ†ã‚’**ä¸€è¡Œãšã¤è©³ç´°ã«ã‚³ãƒ¡ãƒ³ãƒˆä»˜ãã§è§£èª¬**ã—ã¾ã—ãŸï¼

## ğŸ¯ ç‰¹ã«é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

### **1. ãƒ†ã‚¹ãƒˆã®æµã‚Œ**
```
æº–å‚™ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ â†’ APIå‘¼ã³å‡ºã— â†’ çµæœæ¤œè¨¼ â†’ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
```

### **2. ãƒ¢ãƒƒã‚¯åŒ–ã®é‡è¦æ€§**
- **APIå‘¼ã³å‡ºã—**: `mockAxios` ã§å®Ÿéš›ã®ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ã‚ãšã«ãƒ†ã‚¹ãƒˆ
- **ãƒ–ãƒ©ã‚¦ã‚¶æ©Ÿèƒ½**: `window.scrollTo` ãªã©ã‚’ãƒ¢ãƒƒã‚¯åŒ–
- **å¤–éƒ¨ä¾å­˜**: ä»£ç†åº—æƒ…å ±å–å¾—ãªã©ã‚’ãƒ¢ãƒƒã‚¯åŒ–

### **3. éåŒæœŸå‡¦ç†ã®åˆ¶å¾¡**
- `await flushPromises()`: Promiseå®Œäº†ã¾ã§å¾…æ©Ÿ
- `await wrapper.vm.$nextTick()`: Vue.jsã®DOMæ›´æ–°å®Œäº†ã¾ã§å¾…æ©Ÿ

### **4. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ**
ã“ã®ãƒ†ã‚¹ãƒˆã¯å˜ç´”ãªUIè¡¨ç¤ºç¢ºèªã§ã¯ãªãã€**ä¿é™ºæ¥­ç•Œã®è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«**ã‚’æ­£ç¢ºã«å®Ÿè£…ã§ãã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š

- å¹´é½¢ã«ã‚ˆã‚‹å•†å“è¡¨ç¤ºåˆ¶å¾¡
- æ€§åˆ¥ã«ã‚ˆã‚‹å•†å“è¡¨ç¤ºåˆ¶å¾¡  
- æµå…¥çµŒè·¯ã«ã‚ˆã‚‹åˆæœŸé¸æŠå•†å“ã®å¤‰æ›´
- ä»£ç†åº—è¨­å®šã«ã‚ˆã‚‹å•†å“å–æ‰±ã®åˆ¶å¾¡

æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®æ–¹ã¯ã€ã“ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰ **ã€Œå®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã‚’ã‚³ãƒ¼ãƒ‰ã§ã©ã†è¡¨ç¾ã—ã€ã©ã†ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹ã€** ã®è‰¯ã„ä¾‹ã‚’å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ï¼

ä½•ã‹ç‰¹å®šã®éƒ¨åˆ†ã«ã¤ã„ã¦ã‚ˆã‚Šè©³ã—ãçŸ¥ã‚ŠãŸã„ç®‡æ‰€ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ãŠèã‹ã›ãã ã•ã„ï¼

ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
# Vue.js ä¿é™ºå•†å“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰è©³ç´°è§£èª¬

## ğŸ“¦ importæ–‡ã®è§£èª¬

```javascript
// Vue.js ã®ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
// mount: Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿéš›ã®DOMã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹é–¢æ•°
// createLocalVue: ãƒ†ã‚¹ãƒˆç”¨ã®ç‹¬ç«‹ã—ãŸVueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
import { mount, createLocalVue } from '@vue/test-utils'

// ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import G01SimulationPage from '@/pages/G01SimulationPage.vue'

// éåŒæœŸå‡¦ç†ï¼ˆPromiseï¼‰ã®å®Œäº†ã‚’å¾…ã¤ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
import flushPromises from 'flush-promises'

// APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆaxiosï¼‰ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import api from '@/services/api'

// axiosã®HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ¢ãƒƒã‚¯åŒ–ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
import MockAdapter from 'axios-mock-adapter'

// Vue Routerï¼ˆãƒšãƒ¼ã‚¸é·ç§»æ©Ÿèƒ½ï¼‰ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import Router from 'vue-router'

// Vuexï¼ˆçŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import Vuex from 'vuex';
```

## âš™ï¸ åˆæœŸè¨­å®šã®è§£èª¬

```javascript
// MockAdapterã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆï¼ˆAPIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ¢ãƒƒã‚¯åŒ–ï¼‰
const mockAxios = new MockAdapter(api)

// ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ­ãƒ¼ã‚«ãƒ«Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
const localVue = createLocalVue()

// ãƒ­ãƒ¼ã‚«ãƒ«Vueã«Vue Routerãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ 
localVue.use(Router)

// ãƒ­ãƒ¼ã‚«ãƒ«Vueã«Vuexãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ 
localVue.use(Vuex)

// Jestã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã‚’10ç§’ã«è¨­å®šï¼ˆéåŒæœŸå‡¦ç†å¯¾å¿œï¼‰
jest.setTimeout(10000);

// ãƒ–ãƒ©ã‚¦ã‚¶ã®scrollToé–¢æ•°ã‚’ãƒ¢ãƒƒã‚¯åŒ–ï¼ˆãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã¯ä¸è¦ï¼‰
window.scrollTo = jest.fn()
```

## ğŸ—ï¸ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆé–¢æ•°ã®è§£èª¬

```javascript
// å¹´é½¢è¨ˆç®—APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹é–¢æ•°
const getDateCalculate = () => {
  // æˆ»ã‚Šå€¤ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®šç¾©
  const tmp = {
    result: true,           // APIå‘¼ã³å‡ºã—æˆåŠŸãƒ•ãƒ©ã‚°
    transType: '1',        // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—
    data: {
      calcBaseDate: '2019-10-01',  // è¨ˆç®—åŸºæº–æ—¥
      fullAge: 20                   // æº€å¹´é½¢
    }
  }
  // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã‚’è¿”ã™ï¼ˆå…ƒãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ã‚’é˜²ãï¼‰
  return JSON.parse(JSON.stringify(tmp))
}
```

```javascript
// ä¿é™ºæ–™ç‡ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹é–¢æ•°ï¼ˆéå¸¸ã«é•·ã„ãƒ‡ãƒ¼ã‚¿ï¼‰
const getInsurancerates = () => {
  const tmp = {
    result: true,     // APIæˆåŠŸãƒ•ãƒ©ã‚°
    transType: '1',   // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—
    data: [           // ä¿é™ºå•†å“ãƒ‡ãƒ¼ã‚¿ã®é…åˆ—
      {
        insuranceCd: "201",           // ä¿é™ºå•†å“ã‚³ãƒ¼ãƒ‰
        amountFixedFlag: false,       // é‡‘é¡å›ºå®šãƒ•ãƒ©ã‚°
        unit: 1000,                   // å˜ä½ï¼ˆ1000å††å˜ä½ï¼‰
        benefitType: "1",             // çµ¦ä»˜ã‚¿ã‚¤ãƒ—
        benefitRate: null,            // çµ¦ä»˜ç‡
        opeTypeCd: "3",              // æ‰‹è¡“ã‚¿ã‚¤ãƒ—ã‚³ãƒ¼ãƒ‰
        opeRate: null,               // æ‰‹è¡“ç‡
        sixRate: null,               // 6å¤§ç–¾ç—…ç‡
        cancerTreatmentBenefits: null, // ãŒã‚“æ²»ç™‚çµ¦ä»˜
        cancerDifferenceBed: null,    // ãŒã‚“å·®é¡ãƒ™ãƒƒãƒ‰
        gender: "2",                  // æ€§åˆ¥ï¼ˆ2=å¥³æ€§ï¼‰
        age: 20,                      // å¹´é½¢
        amount60: 500,                // 60æ­³æ™‚ã®ä¿é™ºæ–™
        amount65: 510,                // 65æ­³æ™‚ã®ä¿é™ºæ–™
        amount70: 520,                // 70æ­³æ™‚ã®ä¿é™ºæ–™
        amount75: 530,                // 75æ­³æ™‚ã®ä¿é™ºæ–™
        amount80: 540,                // 80æ­³æ™‚ã®ä¿é™ºæ–™
        amount85: 550,                // 85æ­³æ™‚ã®ä¿é™ºæ–™
        amountLife: 560,              // çµ‚èº«ã®ä¿é™ºæ–™
        digitUnderDecimal: "3"        // å°æ•°ç‚¹ä»¥ä¸‹æ¡æ•°
      },
      // ... ä»–ã®ä¿é™ºå•†å“ãƒ‡ãƒ¼ã‚¿ãŒç¶šã
    ]
  }
  
  // æ–™ç‡ãƒ‡ãƒ¼ã‚¿ã‚’å®Ÿéš›ã®å€¤ã«å¤‰æ›ã™ã‚‹å‡¦ç†
  for (let index in tmp.data) {
    // é‡‘é¡å›ºå®šã§ãªã„å ´åˆã®å‡¦ç†
    if (!tmp.data[index].amountFixedFlag) {
      // å„å¹´é½¢ã®ä¿é™ºæ–™ã‚’å˜ä½ã§å‰²ã£ã¦å®Ÿéš›ã®æ–™ç‡ã‚’è¨ˆç®—
      tmp.data[index].amount60 /= tmp.data[index].unit;
      tmp.data[index].amount70 /= tmp.data[index].unit;
      tmp.data[index].amount75 /= tmp.data[index].unit;
      tmp.data[index].amount80 /= tmp.data[index].unit;
      tmp.data[index].amount85 /= tmp.data[index].unit;
      tmp.data[index].amountLife /= tmp.data[index].unit;
      tmp.data[index].amount65 /= tmp.data[index].unit;
    }
  }
  // ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã—ã¦è¿”ã™
  return JSON.parse(JSON.stringify(tmp))
}
```

## ğŸ¯ å„ãƒ†ã‚¹ãƒˆå‰ã®å…±é€šè¨­å®š

```javascript
beforeEach(() => {
  // Vuexã‚¹ãƒˆã‚¢ã®åˆæœŸåŒ–
  store = new Vuex.Store({
    modules: {                    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã•ã‚ŒãŸã‚¹ãƒˆã‚¢
      agency: {                   // agencyï¼ˆä»£ç†åº—ï¼‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
        namespaced: true,         // åå‰ç©ºé–“ã‚’ä½¿ç”¨
        state: {                  // çŠ¶æ…‹
          agency: undefined       // ä»£ç†åº—æƒ…å ±ï¼ˆåˆæœŸå€¤ã¯æœªå®šç¾©ï¼‰
        },
        actions: {                // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆéåŒæœŸå‡¦ç†ï¼‰
          getAgency: mockGetAgency, // ä»£ç†åº—æƒ…å ±å–å¾—ï¼ˆãƒ¢ãƒƒã‚¯é–¢æ•°ï¼‰
        },
        getters: {                // ã‚²ãƒƒã‚¿ãƒ¼ï¼ˆçŠ¶æ…‹ã®å–å¾—ï¼‰
          agency: state => state.agency, // ä»£ç†åº—æƒ…å ±ã‚’è¿”ã™
        },
        mutations: {              // ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆçŠ¶æ…‹ã®å¤‰æ›´ï¼‰
          // ä»£ç†åº—æƒ…å ±ã‚’è¨­å®š
          set: (state, payload) => { 
            state.agency = payload.agency; 
          },
          // ä»£ç†åº—æƒ…å ±ã‚’ã‚¯ãƒªã‚¢
          clear: state => { 
            state.agency = undefined; 
          },
        },
      },
    },
  })
  
  // ãƒ¢ãƒƒã‚¯é–¢æ•°ãŒä»£ç†åº—æƒ…å ±ã‚’è¿”ã™ã‚ˆã†ã«è¨­å®š
  // medical_rabbit_dealer_flag: 1 = ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«å…å–æ‰±ã‚ã‚Š
  mockGetAgency.mockResolvedValueOnce({ medical_rabbit_dealer_flag: 1 });
});
```

## ğŸ§ª å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®è§£èª¬

```javascript
// ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®èª¬æ˜
it('ã‚±ãƒ¼ã‚¹ 1-1 å•†å“é¸æŠãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨(å•†å“è¡¨ç¤ºã‚³ãƒ¼ãƒ‰000ã€Œå•†å“é¸æŠãªã—ã€ã€20æ­³ä»¥ä¸Š80æ­³ä»¥ä¸‹ã€ç”·æ€§)', async () => {
  // ãƒ†ã‚¹ãƒˆç”¨ã®å¹´é½¢ã‚’è¨­å®š
  const setFullAge = 20;
  
  // è¨­å®šå¹´é½¢ã‹ã‚‰ç”Ÿå¹´æœˆæ—¥ã‚’è¨ˆç®—
  const { setYear, setDate } = getDateToSet(setFullAge);

  // ã‚¯ãƒƒã‚­ãƒ¼æ“ä½œã®ãƒ¢ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  const $cookies = {
    get: jest.fn(),    // ã‚¯ãƒƒã‚­ãƒ¼å–å¾—é–¢æ•°ã®ãƒ¢ãƒƒã‚¯
    set: jest.fn()     // ã‚¯ãƒƒã‚­ãƒ¼è¨­å®šé–¢æ•°ã®ãƒ¢ãƒƒã‚¯
  }
  
  // å¹´é½¢è¨ˆç®—APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
  let dateCalculate = getDateCalculate()
  dateCalculate.data.calcBaseDate = setDate;  // è¨ˆç®—åŸºæº–æ—¥ã‚’è¨­å®š
  dateCalculate.data.fullAge = setFullAge;    // æº€å¹´é½¢ã‚’è¨­å®š

  // ãƒ¢ãƒƒã‚¯APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¨­å®š
  // POST /date_calculate/ ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã™ã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹
  mockAxios.onPost('/date_calculate/').reply(200, dateCalculate)
  // POST /insurancerates/ ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã™ã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹
  mockAxios.onPost('/insurancerates/').reply(200, getInsurancerates())

  // Vueã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒã‚¦ãƒ³ãƒˆï¼ˆå®Ÿéš›ã®DOMè¦ç´ ã¨ã—ã¦ä½œæˆï¼‰
  wrapper = mount(G01SimulationPage, {
    localVue,                           // ãƒ†ã‚¹ãƒˆç”¨Vueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
    stubs: ['PageTopButton'],           // PageTopButtonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¹ã‚¿ãƒ–åŒ–
    mocks: { $cookies },               // ãƒ¢ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ³¨å…¥
    store,                             // Vuexã‚¹ãƒˆã‚¢ã‚’æ³¨å…¥
    router: new Router()               // Vue Routerã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ³¨å…¥
  })
  
  // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šï¼ˆå•†å“è¡¨ç¤ºã‚³ãƒ¼ãƒ‰000ï¼‰
  wrapper.vm.$router.push({ query: { parm4: '000' } })

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›æ“ä½œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
  wrapper.find('.birthDateYear').setValue(setYear)      // ç”Ÿå¹´ã‚’å…¥åŠ›
  wrapper.find('.birthDateMonth').trigger('click')      // æœˆé¸æŠãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
  await wrapper.vm.$nextTick()                          // DOMæ›´æ–°ã‚’å¾…æ©Ÿ
  wrapper.find('#month_1').setChecked()                 // 1æœˆã‚’é¸æŠ
  await wrapper.vm.$nextTick()                          // DOMæ›´æ–°ã‚’å¾…æ©Ÿ
  wrapper.find('.birthDateDay').trigger('click')        // æ—¥é¸æŠãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
  await wrapper.vm.$nextTick()                          // DOMæ›´æ–°ã‚’å¾…æ©Ÿ
  wrapper.find('#date_1').setChecked()                  // 1æ—¥ã‚’é¸æŠ
  await wrapper.vm.$nextTick()                          // DOMæ›´æ–°ã‚’å¾…æ©Ÿ
  
  // æ€§åˆ¥é¸æŠï¼ˆç”·æ€§=1ï¼‰
  const radioInput = wrapper
    .find('.gender')                    // æ€§åˆ¥é¸æŠã‚¨ãƒªã‚¢ã‚’å–å¾—
    .find("input[value='1']")          // ç”·æ€§ï¼ˆå€¤=1ï¼‰ã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’å–å¾—
  await wrapper.vm.$nextTick()         // DOMæ›´æ–°ã‚’å¾…æ©Ÿ
  await radioInput.setChecked()        // ç”·æ€§ã‚’é¸æŠ

  // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
  wrapper.find('.simulationBtn').trigger('click')
  
  // éåŒæœŸå‡¦ç†ï¼ˆAPIå‘¼ã³å‡ºã—ï¼‰ã®å®Œäº†ã‚’å¾…æ©Ÿ
  await flushPromises()
  await wrapper.vm.$nextTick()         // DOMæ›´æ–°ã‚’å¾…æ©Ÿ

  // ãƒ†ã‚¹ãƒˆçµæœã®æ¤œè¨¼
  // ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ç¤å¥³æ€§å°‚ç”¨ä»¥å¤–ã®å…¨å•†å“ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹
  expect(wrapper.find("input[value='206']").isVisible()).toBe(true)   // ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ç¤: è¡¨ç¤º
  expect(wrapper.find("input[value='999']").isVisible()).toBe(false)  // ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«å…: éè¡¨ç¤ºï¼ˆç”·æ€§ã®ãŸã‚ï¼‰
  expect(wrapper.find("input[value='147']").isVisible()).toBe(true)   // ã‚»ãƒ–ãƒ³: è¡¨ç¤º
  expect(wrapper.find("input[value='153']").isVisible()).toBe(true)   // ãƒ¯ã‚¤ãƒ‰: è¡¨ç¤º
  expect(wrapper.find("input[value='143']").isVisible()).toBe(true)   // ãŒã‚“ä¸€æ™‚é‡‘: è¡¨ç¤º
  expect(wrapper.find("input[value='215']").isVisible()).toBe(true)   // ãŒã‚“æ²»ç™‚æ¥µ: è¡¨ç¤º
  expect(wrapper.find("input[value='223']").isVisible()).toBe(true)   // ãªãªã„ã‚ã‚¹ãƒªãƒ¼: è¡¨ç¤º
  
  // ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ç¤ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹
  expect(wrapper.find("input[value='206']").element.checked).toBe(true)   // ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«ç¤: é¸æŠæ¸ˆã¿
  expect(wrapper.find("input[value='999']").element.checked).toBe(false)  // ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«å…: æœªé¸æŠ
  expect(wrapper.find("input[value='147']").element.checked).toBe(false)  // ã‚»ãƒ–ãƒ³: æœªé¸æŠ
  expect(wrapper.find("input[value='153']").element.checked).toBe(false)  // ãƒ¯ã‚¤ãƒ‰: æœªé¸æŠ
  expect(wrapper.find("input[value='143']").element.checked).toBe(false)  // ãŒã‚“ä¸€æ™‚é‡‘: æœªé¸æŠ
  expect(wrapper.find("input[value='215']").element.checked).toBe(false)  // ãŒã‚“æ²»ç™‚æ¥µ: æœªé¸æŠ
  expect(wrapper.find("input[value='223']").element.checked).toBe(false)  // ãªãªã„ã‚ã‚¹ãƒªãƒ¼: æœªé¸æŠ
  
  // ãƒ†ã‚¹ãƒˆçµ‚äº†å¾Œã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ•ãƒ©ã‚°ã‚’è¨­å®š
  shouldResetParm4ToBlankor000 = true;
})
```

## ğŸ§¹ ãƒ†ã‚¹ãƒˆå¾Œã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```javascript
afterEach(() => {
  // å•†å“è¡¨ç¤ºã‚³ãƒ¼ãƒ‰"000"ã®å ´åˆã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†
  if (shouldResetParm4ToBlankor000) {
    // å•†å“è¡¨ç¤ºã‚³ãƒ¼ãƒ‰ãªã—"000"ã®å ´åˆã¯ã€param4=000ã§åˆæœŸåŒ–ã™ã‚‹
    wrapper.vm.$router.push({ query: { parm4: '000' } });
    shouldResetParm4ToBlankor000 = false;  // ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
  } else {
    // ãã‚Œä»¥å¤–ã®å ´åˆã¯ç©ºæ–‡å­—ã§åˆæœŸåŒ–
    wrapper.vm.$router.push({ query: { parm4: '' } });
  }
});
```

## ğŸ”§ ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã®è§£èª¬

```javascript
// è¨­å®šã™ã‚‹å¹´é½¢ã®è¥¿æš¦ã‚’å–å¾—ã™ã‚‹é–¢æ•°
function getDateToSet(setAge) {
  // ç¾åœ¨ã®è¥¿æš¦ã‚’å–å¾—
  const currentYear = new Date().getFullYear();
  
  // è¨­å®šã™ã‚‹å¹´é½¢ã®è¥¿æš¦ã‚’è¨ˆç®—ï¼ˆç¾åœ¨å¹´ - å¹´é½¢ï¼‰
  const setYear = String(currentYear - setAge)
  
  // ç”Ÿå¹´æœˆæ—¥ã‚’ 'YYYY-01-01' å½¢å¼ã§ä½œæˆ
  const setDate = setYear + '-01-01'
  
  // è¥¿æš¦ã¨æ—¥ä»˜ã®ä¸¡æ–¹ã‚’è¿”ã™
  return { setYear, setDate };
}
```

## ğŸ’¡ é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

### 1. **éåŒæœŸå‡¦ç†ã®æ‰±ã„**
```javascript
await flushPromises()        // APIå‘¼ã³å‡ºã—å®Œäº†ã¾ã§å¾…æ©Ÿ
await wrapper.vm.$nextTick() // DOMæ›´æ–°å®Œäº†ã¾ã§å¾…æ©Ÿ
```

### 2. **ãƒ¢ãƒƒã‚¯ã®æ´»ç”¨**
```javascript
mockAxios.onPost('/date_calculate/').reply(200, dateCalculate) // APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ¢ãƒƒã‚¯åŒ–
mockGetAgency.mockResolvedValueOnce({...})                     // é–¢æ•°ã®æˆ»ã‚Šå€¤ã‚’ãƒ¢ãƒƒã‚¯åŒ–
```

### 3. **DOMã®æ“ä½œã¨ãƒ†ã‚¹ãƒˆ**
```javascript
wrapper.find('.birthDateYear').setValue(setYear)      // å…¥åŠ›å€¤ã®è¨­å®š
wrapper.find('#month_1').setChecked()                 // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®é¸æŠ
expect(wrapper.find("input[value='206']").isVisible()).toBe(true) // è¡¨ç¤ºçŠ¶æ…‹ã®ç¢ºèª
```

ã“ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯ã€å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã¦ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹éå¸¸ã«é‡è¦ãªãƒ†ã‚¹ãƒˆã§ã™ï¼
