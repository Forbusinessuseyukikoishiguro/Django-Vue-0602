# Vue.js ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ

Vue.js ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’åŠ¹ç‡çš„ã«æ›¸ããŸã‚ã®å®Ÿè·µçš„ãªãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã§ã™ã€‚ã‚³ãƒ”ãƒšã—ã¦ä½¿ãˆã‚‹ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚’ä¸­å¿ƒã«æ§‹æˆã—ã¦ã„ã¾ã™ã€‚

## ğŸ“‹ åŸºæœ¬ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

### åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```javascript
import { mount, shallowMount } from '@vue/test-utils'
import Component from '@/components/Component.vue'

describe('Component.vue', () => {
  let wrapper

  beforeEach(() => {
    wrapper = mount(Component, {
      propsData: {
        // props here
      },
      mocks: {
        // mocks here
      }
    })
  })

  afterEach(() => {
    wrapper.destroy()
  })

  it('should render correctly', () => {
    expect(wrapper.exists()).toBe(true)
  })
})
```

### Vue 3 å¯¾å¿œç‰ˆ

```javascript
import { mount } from '@vue/test-utils'
import Component from '@/components/Component.vue'

describe('Component.vue', () => {
  let wrapper

  beforeEach(() => {
    wrapper = mount(Component, {
      props: {
        // props here
      },
      global: {
        mocks: {
          // mocks here
        }
      }
    })
  })

  afterEach(() => {
    wrapper.unmount()
  })

  it('should render correctly', () => {
    expect(wrapper.exists()).toBe(true)
  })
})
```

## ğŸ¯ ã‚ˆãä½¿ã†ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³

### å­˜åœ¨ãƒ»è¡¨ç¤ºç¢ºèª

```javascript
// è¦ç´ ã®å­˜åœ¨ç¢ºèª
expect(wrapper.find('.class-name').exists()).toBe(true)
expect(wrapper.find('#id-name').exists()).toBe(false)

// è¦ç´ ã®è¡¨ç¤ºãƒ»éè¡¨ç¤º
expect(wrapper.find('.element').isVisible()).toBe(true)
expect(wrapper.find('.hidden').isVisible()).toBe(false)

// è¦ç´ æ•°ã®ç¢ºèª
expect(wrapper.findAll('.item').length).toBe(3)
expect(wrapper.findAll('li')).toHaveLength(5)
```

### ãƒ†ã‚­ã‚¹ãƒˆãƒ»å±æ€§ç¢ºèª

```javascript
// ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹
expect(wrapper.find('h1').text()).toBe('ã‚¿ã‚¤ãƒˆãƒ«')
expect(wrapper.text()).toContain('å«ã¾ã‚Œã‚‹æ–‡å­—åˆ—')

// HTMLå†…å®¹
expect(wrapper.find('.content').html()).toContain('<span>')

// å±æ€§ç¢ºèª
expect(wrapper.find('input').attributes('type')).toBe('text')
expect(wrapper.find('button').attributes('disabled')).toBe('disabled')

// ã‚¯ãƒ©ã‚¹ç¢ºèª
expect(wrapper.find('.button').classes()).toContain('active')
expect(wrapper.find('.button').classes('active')).toBe(true)
```

### ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 

```javascript
// input ã®å€¤
expect(wrapper.find('input').element.value).toBe('å…¥åŠ›å€¤')

// select ã®é¸æŠ
expect(wrapper.find('select').element.value).toBe('option1')

// checkbox ã®çŠ¶æ…‹
expect(wrapper.find('input[type="checkbox"]').element.checked).toBe(true)

// radio ã®çŠ¶æ…‹
expect(wrapper.find('input[type="radio"]').element.checked).toBe(false)
```

## ğŸ–±ï¸ DOMæ“ä½œã¨ã‚¤ãƒ™ãƒ³ãƒˆ

### åŸºæœ¬çš„ãªã‚¤ãƒ™ãƒ³ãƒˆ

```javascript
// ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
await wrapper.find('button').trigger('click')

// input ã‚¤ãƒ™ãƒ³ãƒˆ
await wrapper.find('input').setValue('æ–°ã—ã„å€¤')

// change ã‚¤ãƒ™ãƒ³ãƒˆ
await wrapper.find('select').setValue('option2')

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
await wrapper.find('form').trigger('submit')

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆ
await wrapper.find('input').trigger('keydown', { key: 'Enter' })
```

### ãƒ•ã‚©ãƒ¼ãƒ æ“ä½œ

```javascript
// ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
const input = wrapper.find('input[type="text"]')
await input.setValue('ãƒ†ã‚¹ãƒˆå…¥åŠ›')

// ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
const checkbox = wrapper.find('input[type="checkbox"]')
await checkbox.setChecked(true)

// ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³
const radio = wrapper.find('input[type="radio"][value="option1"]')
await radio.setChecked()

// ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹
const select = wrapper.find('select')
await select.setValue('option2')

// è¤‡æ•°é¸æŠ
const options = wrapper.find('select').findAll('option')
await options.at(1).setSelected()
```

### ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³æ“ä½œã®è©³ç´°ãƒ‘ã‚¿ãƒ¼ãƒ³

```javascript
// ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã®å…¨é¸æŠè‚¢å–å¾—
const options = wrapper.find('select[name="dropdown"]').findAll('option')

// ç‰¹å®šã®ãƒ†ã‚­ã‚¹ãƒˆã§é¸æŠ
const targetOption = options.filter(node => node.text() === 'é¸æŠã—ãŸã„å€¤')
await targetOption.at(0).setSelected()

// å€¤ã§é¸æŠ
await wrapper.find('select').setValue('value1')

// é¸æŠè‚¢ã®ç¢ºèª
expect(options.length).toBe(5)
expect(options.at(0).text()).toBe('ã‚ªãƒ—ã‚·ãƒ§ãƒ³1')
```

## âš¡ éåŒæœŸå‡¦ç†

### Vue ã®æ›´æ–°å¾…ã¡

```javascript
// Vue ã® DOM æ›´æ–°ã‚’å¾…ã¤
await wrapper.vm.$nextTick()

// å…¨ã¦ã® Promise ã‚’å¾…ã¤
import flushPromises from 'flush-promises'
await flushPromises()

// setTimeout ãªã©ã‚’å¾…ã¤
jest.advanceTimersByTime(1000)
```

### APIå‘¼ã³å‡ºã—ã®ãƒ†ã‚¹ãƒˆ

```javascript
// API ãƒ¢ãƒƒã‚¯ã®è¨­å®š
const mockApiCall = jest.fn().mockResolvedValue({ data: 'test' })
wrapper.vm.$api = { getData: mockApiCall }

// ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œ
await wrapper.vm.fetchData()

// ãƒ¢ãƒƒã‚¯ã®å‘¼ã³å‡ºã—ç¢ºèª
expect(mockApiCall).toHaveBeenCalledTimes(1)
expect(mockApiCall).toHaveBeenCalledWith({ id: 1 })
```

## ğŸ­ ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–

### Vuex ã‚¹ãƒˆã‚¢ã®ãƒ¢ãƒƒã‚¯

```javascript
const mockStore = {
  getters: {
    currentUser: () => ({ name: 'ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼' }),
    isLoggedIn: () => true
  },
  dispatch: jest.fn(),
  commit: jest.fn()
}

const wrapper = mount(Component, {
  mocks: {
    $store: mockStore
  }
})
```

### Vue Router ã®ãƒ¢ãƒƒã‚¯

```javascript
const mockRouter = {
  push: jest.fn(),
  replace: jest.fn(),
  go: jest.fn()
}

const mockRoute = {
  params: { id: '123' },
  query: { tab: 'profile' },
  path: '/user/123'
}

const wrapper = mount(Component, {
  mocks: {
    $router: mockRouter,
    $route: mockRoute
  }
})
```

### ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ¢ãƒƒã‚¯

```javascript
// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ¢ãƒƒã‚¯
wrapper.vm.expensiveMethod = jest.fn().mockReturnValue('mocked result')

// å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ¢ãƒƒã‚¯
jest.mock('axios')
const mockedAxios = axios as jest.Mocked<typeof axios>
mockedAxios.get.mockResolvedValue({ data: { result: 'success' } })
```

## ğŸ” ã‚ˆãä½¿ã†ã‚»ãƒ¬ã‚¯ã‚¿ãƒ‘ã‚¿ãƒ¼ãƒ³

```javascript
// CSS ã‚»ãƒ¬ã‚¯ã‚¿
wrapper.find('.class-name')
wrapper.find('#id-name')
wrapper.find('tag-name')
wrapper.find('[data-test="selector"]')

// å±æ€§ã‚»ãƒ¬ã‚¯ã‚¿
wrapper.find('input[type="text"]')
wrapper.find('button[disabled]')
wrapper.find('select[name="dropdown"]')

// Vue ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
wrapper.findComponent({ name: 'ChildComponent' })
wrapper.findComponent(ChildComponent)

// è¤‡æ•°è¦ç´ 
wrapper.findAll('.item')
wrapper.findAll('li').at(0)

// ãƒ†ã‚­ã‚¹ãƒˆã§æ¤œç´¢
wrapper.findAll('button').filter(node => node.text() === 'ã‚¯ãƒªãƒƒã‚¯')
```

## ğŸ“Š ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£

### Props ã®ãƒ†ã‚¹ãƒˆ

```javascript
// Props ã®ç¢ºèª
expect(wrapper.vm.$props.title).toBe('ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒˆãƒ«')
expect(wrapper.props('isActive')).toBe(true)

// Props ã®å¤‰æ›´
await wrapper.setProps({ title: 'æ–°ã—ã„ã‚¿ã‚¤ãƒˆãƒ«' })
```

### Data ã®ãƒ†ã‚¹ãƒˆ

```javascript
// Data ã®ç¢ºèª
expect(wrapper.vm.loading).toBe(false)
expect(wrapper.vm.$data.items).toHaveLength(3)

// Data ã®å¤‰æ›´
await wrapper.setData({ loading: true })
```

### Computed ã®ãƒ†ã‚¹ãƒˆ

```javascript
// Computed ã®ç¢ºèª
expect(wrapper.vm.computedProperty).toBe('æœŸå¾…å€¤')

// ä¾å­˜ã™ã‚‹ data ã‚’å¤‰æ›´ã—ã¦ computed ã®å¤‰åŒ–ã‚’ç¢ºèª
await wrapper.setData({ baseValue: 10 })
expect(wrapper.vm.doubledValue).toBe(20)
```

## ğŸš¨ ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«ã®ãƒ†ã‚¹ãƒˆ

### ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ

```javascript
// ã‚¤ãƒ™ãƒ³ãƒˆã®ç™ºç«ç¢ºèª
wrapper.vm.$emit('custom-event', { data: 'test' })
expect(wrapper.emitted('custom-event')).toBeTruthy()
expect(wrapper.emitted('custom-event')[0]).toEqual([{ data: 'test' }])

// ã‚¤ãƒ™ãƒ³ãƒˆã®ç™ºç«å›æ•°
expect(wrapper.emitted('custom-event')).toHaveLength(2)

// ã‚¤ãƒ™ãƒ³ãƒˆã®å¼•æ•°ç¢ºèª
const emittedEvents = wrapper.emitted('custom-event')
expect(emittedEvents[0][0]).toEqual({ id: 1, name: 'test' })
```

### è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡

```javascript
const parentHandler = jest.fn()

const wrapper = mount(ParentComponent, {
  listeners: {
    'child-event': parentHandler
  }
})

// å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«
await wrapper.findComponent(ChildComponent).vm.$emit('child-event', 'data')

expect(parentHandler).toHaveBeenCalledWith('data')
```

## ğŸ”§ ãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒ¼ãƒ‰

```javascript
// HTML æ§‹é€ ã®ç¢ºèª
console.log(wrapper.html())

// Vue ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç¢ºèª
console.log(wrapper.vm)

// ç‰¹å®šè¦ç´ ã®ç¢ºèª
console.log(wrapper.find('.element').element)

// å…¨ã¦ã®è¦ç´ ã®ç¢ºèª
wrapper.findAll('.item').wrappers.forEach((item, index) => {
  console.log(`Item ${index}:`, item.text())
})

// ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ±
try {
  expect(wrapper.find('.not-found').exists()).toBe(true)
} catch (error) {
  console.log('Available elements:', wrapper.findAll('*').wrappers.map(el => el.element.tagName))
  throw error
}
```

## â±ï¸ ã‚¿ã‚¤ãƒãƒ¼ãƒ»æ™‚é–“ã®ãƒ†ã‚¹ãƒˆ

```javascript
// ã‚¿ã‚¤ãƒãƒ¼ã®ãƒ¢ãƒƒã‚¯
beforeEach(() => {
  jest.useFakeTimers()
})

afterEach(() => {
  jest.useRealTimers()
})

// setTimeout ã®ãƒ†ã‚¹ãƒˆ
wrapper.vm.startTimer()
jest.advanceTimersByTime(1000)
expect(wrapper.vm.timeElapsed).toBe(1)

// setInterval ã®ãƒ†ã‚¹ãƒˆ
jest.advanceTimersByTime(5000)
expect(wrapper.vm.counter).toBe(5)
```

## ğŸ¨ ã‚¹ã‚¿ã‚¤ãƒ«ãƒ»CSS ã®ãƒ†ã‚¹ãƒˆ

```javascript
// ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«
expect(wrapper.find('.element').element.style.display).toBe('none')

// CSS ã‚¯ãƒ©ã‚¹
expect(wrapper.find('.button').classes()).toContain('active')
expect(wrapper.find('.button').classes('disabled')).toBe(false)

// ã‚¹ã‚¿ã‚¤ãƒ«å±æ€§
const element = wrapper.find('.styled-element')
expect(element.attributes('style')).toContain('color: red')
```

## ğŸ”„ ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ

```javascript
// created ãƒ•ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
const createdSpy = jest.spyOn(Component.options, 'created')
mount(Component)
expect(createdSpy).toHaveBeenCalled()

// mounted ãƒ•ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
const mountedSpy = jest.fn()
mount(Component, {
  mounted: mountedSpy
})
expect(mountedSpy).toHaveBeenCalled()

// destroyed ãƒ•ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆ
const destroyedSpy = jest.fn()
wrapper = mount(Component, {
  destroyed: destroyedSpy
})
wrapper.destroy()
expect(destroyedSpy).toHaveBeenCalled()
```

## ğŸ“ ã‚ˆãã‚ã‚‹ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³

### æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

```javascript
// v-if ã®ãƒ†ã‚¹ãƒˆ
await wrapper.setData({ showElement: true })
expect(wrapper.find('.conditional-element').exists()).toBe(true)

await wrapper.setData({ showElement: false })
expect(wrapper.find('.conditional-element').exists()).toBe(false)
```

### ãƒªã‚¹ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

```javascript
// v-for ã®ãƒ†ã‚¹ãƒˆ
const items = ['item1', 'item2', 'item3']
await wrapper.setData({ items })

const listItems = wrapper.findAll('.list-item')
expect(listItems).toHaveLength(3)
expect(listItems.at(0).text()).toBe('item1')
```

### ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```javascript
// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ
const input = wrapper.find('input[type="email"]')
await input.setValue('invalid-email')
await input.trigger('blur')

expect(wrapper.find('.error-message').exists()).toBe(true)
expect(wrapper.find('.error-message').text()).toContain('æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹')
```

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

```javascript
// ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚é–“ã®æ¸¬å®š
const startTime = performance.now()
const wrapper = mount(Component)
const endTime = performance.now()

expect(endTime - startTime).toBeLessThan(100) // 100ms ä»¥å†…

// ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®ç¢ºèª
const initialMemory = process.memoryUsage().heapUsed
// ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
wrapper.destroy()
const finalMemory = process.memoryUsage().heapUsed
expect(finalMemory).toBeLessThanOrEqual(initialMemory * 1.1) // 10% ä»¥å†…ã®å¢—åŠ 
```

## ğŸ“‹ Jest è¨­å®šã®ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

```javascript
// jest.config.js ã®åŸºæœ¬è¨­å®š
module.exports = {
  testEnvironment: 'jsdom',
  moduleNameMapping: {
    '^@/(.*)$': '<rootDir>/src/$1'
  },
  transform: {
    '^.+\\.vue$': 'vue-jest',
    '^.+\\.js$': 'babel-jest'
  },
  collectCoverageFrom: [
    'src/**/*.{js,vue}',
    '!src/main.js'
  ]
}
```

ã“ã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã‚’å‚è€ƒã«ã€åŠ¹ç‡çš„ãªVue.jsãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ï¼å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
